<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Sideline Satirist - Premium Sports Satire</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Space+Grotesk:wght@300;400;500;600;700&family=Syncopate:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>
</head>
<body>
    <div class="cursor"></div>
    <div class="cursor-follower"></div>

    <nav class="navbar">
        <div class="navbar-content">
            <a href="index.html" class="logo">
                <i class="fas fa-football-ball logo-icon"></i>
                <span class="logo-text">The Sideline Satirist</span>
            </a>
            <ul class="nav-links">
                <li><a href="index.html" class="nav-link">Latest</a></li>
                <li><a href="categories.html" class="nav-link">Categories</a></li>
                <li><a href="about.html" class="nav-link">About</a></li>
                <li><a href="#" class="subscribe-btn">Subscribe</a></li>
            </ul>
        </div>
    </nav>

    <header class="hero">
        <div class="hero-particles" id="particles"></div>
        <div class="hero-content">
            <h1 class="hero-title">Where Sports Meet Sarcasm</h1>
            <p class="hero-subtitle">Premium satirical sports coverage that's almost as reliable as instant replay</p>
        </div>
        <div class="scroll-indicator">
            <i class="fas fa-chevron-down"></i>
        </div>
    </header>

    <main>
        <section class="featured-section">
            <div class="featured-grid" id="featured-post-container"></div>
        </section>

        <section class="latest-posts">
            <div class="container">
                <h2 class="section-title">Latest Stories</h2>
                <div class="posts-grid" id="posts-grid-container"></div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-section">
                    <h3>The Sideline Satirist</h3>
                    <p>Making sports funny since whenever we started doing this.</p>
                    <div class="social-links">
                        <a href="#" class="social-link" aria-label="Twitter">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="#" class="social-link" aria-label="Facebook">
                            <i class="fab fa-facebook"></i>
                        </a>
                        <a href="#" class="social-link" aria-label="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li class="footer-link"><a href="categories.html">Categories</a></li>
                        <li class="footer-link"><a href="about.html">About Us</a></li>
                        <li class="footer-link"><a href="#">Subscribe</a></li>
                        <li class="footer-link"><a href="#">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Categories</h3>
                    <ul class="footer-links">
                        <li class="footer-link"><a href="#">Football</a></li>
                        <li class="footer-link"><a href="#">Basketball</a></li>
                        <li class="footer-link"><a href="#">Baseball</a></li>
                        <li class="footer-link"><a href="#">Soccer</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 The Sideline Satirist. All rights probably reserved.</p>
            </div>
        </div>
    </footer>

    <script>
       // Custom Cursor
const cursor = document.querySelector('.cursor');
const cursorFollower = document.querySelector('.cursor-follower');

document.addEventListener('mousemove', (e) => {
    cursor.style.left = e.clientX + 'px';
    cursor.style.top = e.clientY + 'px';

    setTimeout(() => {
        cursorFollower.style.left = e.clientX + 'px';
        cursorFollower.style.top = e.clientY + 'px';
    }, 100);
});

// Navbar Hide on Scroll
let lastScroll = 0;
window.addEventListener('scroll', () => {
    const currentScroll = window.pageYOffset;
    const navbar = document.querySelector('.navbar');

    if (currentScroll <= 0) {
        navbar.classList.remove('hidden');
        return;
    }

    if (currentScroll > lastScroll && !navbar.classList.contains('hidden')) {
        navbar.classList.add('hidden');
    } else if (currentScroll < lastScroll && navbar.classList.contains('hidden')) {
        navbar.classList.remove('hidden');
    }

    lastScroll = currentScroll;
});

// Particle Effect
function createParticles() {
    const particles = document.getElementById('particles');
    for (let i = 0; i < 50; i++) {
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.left = Math.random() * 100 + 'vw';
        particle.style.animationDelay = Math.random() * 20 + 's';
        particles.appendChild(particle);
    }
}
createParticles();

// Intersection Observer for Animations
const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.classList.add('visible');
        }
    });
}, {
    threshold: 0.1
});

document.querySelectorAll('.fade-in, .post-card, .section-title, .featured-image, .featured-content').forEach((el) => {
    observer.observe(el);
});
// GitHub API and content settings
const repoOwner = 'lawrence18365'; // Your GitHub username
const repoName = 'sportsblog';  // Your repository name
const postsDir = 'posts';      // Folder containing your posts
const converter = new showdown.Converter(); // Markdown converter

// Function to format dates
function formatDate(dateString) {
    return new Date(dateString).toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    });
}

// Function to create HTML for featured post
function createFeaturedPost(post) {
    const postContentHtml = converter.makeHtml(post.content);
    return `
        <div class="featured-image fade-in">
            <img src="${post.image}" alt="${post.title}" loading="lazy">
        </div>
        <div class="featured-content fade-in">
            <span class="category-badge">${post.category}</span>
            <h2 class="featured-title">${post.title}</h2>
            <div class="meta-info">
                <span class="meta-item">
                    <i class="far fa-calendar"></i>
                    ${formatDate(post.date)}
                </span>
                <span class="meta-item">
                    <i class="far fa-user"></i>
                    ${post.author}
                </span>
            </div>
            <p>${post.excerpt}</p>
            ${postContentHtml} 
            <a href="${post.html_url}" target="_blank" class="read-more">View on GitHub →</a>
        </div>
    `;
}

// Function to create HTML for a post card
function createPostCard(post, index) {
    const postContentHtml = converter.makeHtml(post.content);
    return `
        <article class="post-card fade-in" style="transition-delay: ${index * 0.1}s">
            <img src="${post.image}" alt="${post.title}" class="post-image" loading="lazy">
            <div class="post-content">
                <span class="category-badge">${post.category}</span>
                <h3 class="post-title">${post.title}</h3>
                <div class="meta-info">
                    <span class="meta-item">
                        <i class="far fa-calendar"></i>
                        ${formatDate(post.date)}
                    </span>
                </div>
                <p>${post.excerpt}</p>
                ${postContentHtml}
                <a href="${post.html_url}" target="_blank" class="read-more">View on GitHub →</a>
            </div>
        </article>
    `;
}

// Fetch posts from GitHub
async function getPosts(repoOwner, repoName, postsDir) {
    const apiUrl = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${postsDir}`;

    try {
        const response = await fetch(apiUrl);
        if (!response.ok) {
            throw new Error(`GitHub API error: ${response.status}`);
        }

        const data = await response.json();

        // Filter for Markdown files and process them
        const posts = await Promise.all(data
            .filter(file => file.name.endsWith('.md'))
            .map(async (file) => {
                const postResponse = await fetch(file.download_url);
                if (!postResponse.ok) {
                    console.error(`Error fetching post ${file.name}:`, postResponse.status);
                    return null;
                }
                const postContent = await postResponse.text();
                const frontMatterMatch = postContent.match(/^---\n([\s\S]*?)\n---/);
                const frontMatter = frontMatterMatch ? jsyaml.load(frontMatterMatch[1]) : {};

                // Process image paths in Markdown content
                const githubRawUrl = `https://raw.githubusercontent.com/${repoOwner}/${repoName}/main/${postsDir}/`;
                let processedContent = postContent.replace(/!\[.*?\]\((.*?)\)/g, (match, imagePath) => {
                    if (imagePath.startsWith('http')) {
                        return match; // Absolute URL, no change
                    }
                    return match.replace(imagePath, `${githubRawUrl}${imagePath}`);
                });

                return {
                    ...file,
                    ...frontMatter,
                    title: frontMatter.title || 'Untitled Post',
                    excerpt: frontMatter.excerpt || 'No excerpt available',
                    date: frontMatter.date || new Date().toISOString(),
                    author: frontMatter.author || 'Anonymous',
                    category: frontMatter.category || 'Uncategorized',
                    image: frontMatter.image || 'placeholder.svg',
                    content: processedContent // Markdown content with adjusted image paths
                };
            }));

        // Filter out any null posts and sort by date
        return posts.filter(post => post !== null).sort((a, b) => new Date(b.date) - new Date(a.date));

    } catch (error) {
        console.error('Error fetching or processing posts:', error);
        return [];
    }
}

// Initialize blog
async function initializeBlog() {
    const featuredPostContainer = document.getElementById('featured-post-container');
    const postsGridContainer = document.getElementById('posts-grid-container');

    // Show loading states (optional - improve with placeholders)
    featuredPostContainer.innerHTML = '<div class="loading">Loading Featured Post...</div>';
    postsGridContainer.innerHTML = '<div class="loading">Loading Posts...</div>';

    try {
        const posts = await getPosts(repoOwner, repoName, postsDir);

        if (posts.length === 0) {
            throw new Error('No posts found');
        }

        // Featured post
        const featuredPostData = posts.find(post => post.featured) || posts[0];
        featuredPostContainer.innerHTML = createFeaturedPost(featuredPostData);

        // Regular posts (exclude featured post)
        const regularPosts = posts.filter(post => post !== featuredPostData);
        postsGridContainer.innerHTML = regularPosts.map(createPostCard).join('');

    } catch (error) {
        console.error('Error initializing blog:', error);
        featuredPostContainer.innerHTML = '<div class="error">Error loading featured post.</div>';
        postsGridContainer.innerHTML = '<div class="error">Error loading posts.</div>';
    }
}

// Call initializeBlog on DOMContentLoaded
document.addEventListener('DOMContentLoaded', initializeBlog);
    </script>
</body>
</html>
